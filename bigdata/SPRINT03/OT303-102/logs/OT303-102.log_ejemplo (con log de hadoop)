mcoutada@DESKTOP-02T1JP6:~/alkemy/OT303-python/bigdata/SPRINT03/OT303-102$ python3 main.py
17/10/2022:INFO:/main.py:Starting __main__.main()
17/10/2022:INFO:/main.py:/home/mcoutada/hadoop/hadoop-3.3.4/share/hadoop/tools/lib/hadoop-streaming-3.3.4.jar: OK
17/10/2022:INFO:/main.py:/home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/mapper1.py: OK
17/10/2022:INFO:/main.py:/home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/mapper2.py: OK
17/10/2022:INFO:/main.py:/home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/mapper3.py: OK
17/10/2022:INFO:/main.py:/home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/reducer1.py: OK
17/10/2022:INFO:/main.py:/home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/reducer2.py: OK
17/10/2022:INFO:/main.py:/home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/reducer3.py: OK
17/10/2022:INFO:/main.py:/alkemybigdata/Stack_Overflow_11-2010/112010_Meta_Stack_Overflow/posts.xml: OK
17/10/2022:INFO:/main.py:/alkemybigdata/Stack_Overflow_11-2010/112010_Stack_Overflow/posts.xml: OK
17/10/2022:INFO:/main.py:Processing:
hadoop jar /home/mcoutada/hadoop/hadoop-3.3.4/share/hadoop/tools/lib/hadoop-streaming-3.3.4.jar -input /alkemybigdata/Stack_Overflow_11-2010/112010_Meta_Stack_Overflow/posts.xml -output /alkemybigdata/Stack_Overflow_11-2010/output -mapper "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/mapper1.py" -reducer "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/reducer1.py"
2022-10-17 18:13:49,523 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:13:49,695 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:13:49,911 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/mcoutada/.staging/job_1665599427989_0039
2022-10-17 18:13:50,150 INFO mapred.FileInputFormat: Total input files to process : 1
2022-10-17 18:13:50,217 INFO mapreduce.JobSubmitter: number of splits:2
2022-10-17 18:13:50,331 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1665599427989_0039
2022-10-17 18:13:50,331 INFO mapreduce.JobSubmitter: Executing with tokens: []
2022-10-17 18:13:50,505 INFO conf.Configuration: resource-types.xml not found
2022-10-17 18:13:50,506 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.
2022-10-17 18:13:50,572 INFO impl.YarnClientImpl: Submitted application application_1665599427989_0039
2022-10-17 18:13:50,617 INFO mapreduce.Job: The url to track the job: http://DESKTOP-02T1JP6.localdomain:8088/proxy/application_1665599427989_0039/
2022-10-17 18:13:50,619 INFO mapreduce.Job: Running job: job_1665599427989_0039
2022-10-17 18:13:56,690 INFO mapreduce.Job: Job job_1665599427989_0039 running in uber mode : false
2022-10-17 18:13:56,691 INFO mapreduce.Job:  map 0% reduce 0%
2022-10-17 18:14:01,758 INFO mapreduce.Job:  map 100% reduce 0%
2022-10-17 18:14:06,795 INFO mapreduce.Job:  map 100% reduce 100%
2022-10-17 18:14:07,812 INFO mapreduce.Job: Job job_1665599427989_0039 completed successfully
2022-10-17 18:14:07,908 INFO mapreduce.Job: Counters: 54
        File System Counters
                FILE: Number of bytes read=340894
                FILE: Number of bytes written=1516009
                FILE: Number of read operations=0
                FILE: Number of large read operations=0
                FILE: Number of write operations=0
                HDFS: Number of bytes read=54797371
                HDFS: Number of bytes written=284
                HDFS: Number of read operations=11
                HDFS: Number of large read operations=0
                HDFS: Number of write operations=2
                HDFS: Number of bytes read erasure-coded=0
        Job Counters 
                Launched map tasks=2
                Launched reduce tasks=1
                Data-local map tasks=2
                Total time spent by all maps in occupied slots (ms)=5897
                Total time spent by all reduces in occupied slots (ms)=2265
                Total time spent by all map tasks (ms)=5897
                Total time spent by all reduce tasks (ms)=2265
                Total vcore-milliseconds taken by all map tasks=5897
                Total vcore-milliseconds taken by all reduce tasks=2265
                Total megabyte-milliseconds taken by all map tasks=6038528
                Total megabyte-milliseconds taken by all reduce tasks=2319360
        Map-Reduce Framework
                Map input records=56977
                Map output records=24127
                Map output bytes=292634
                Map output materialized bytes=340900
                Input split bytes=294
                Combine input records=0
                Combine output records=0
                Reduce input groups=1177
                Reduce shuffle bytes=340900
                Reduce input records=24127
                Reduce output records=10
                Spilled Records=48254
                Shuffled Maps =2
                Failed Shuffles=0
                Merged Map outputs=2
                GC time elapsed (ms)=145
                CPU time spent (ms)=3950
                Physical memory (bytes) snapshot=935800832
                Virtual memory (bytes) snapshot=7682965504
                Total committed heap usage (bytes)=846200832
                Peak Map Physical memory (bytes)=349061120
                Peak Map Virtual memory (bytes)=2561187840
                Peak Reduce Physical memory (bytes)=241729536
                Peak Reduce Virtual memory (bytes)=2562580480
        Shuffle Errors
                BAD_ID=0
                CONNECTION=0
                IO_ERROR=0
                WRONG_LENGTH=0
                WRONG_MAP=0
                WRONG_REDUCE=0
        File Input Format Counters 
                Bytes Read=54797077
        File Output Format Counters 
                Bytes Written=284
2022-10-17 18:14:07,908 INFO streaming.StreamJob: Output directory: /alkemybigdata/Stack_Overflow_11-2010/output
17/10/2022:INFO:/main.py:Output:
1  discussion          2912
2  feature-request     2814
3  bug                 1396
4  support             1261
5  stackoverflow       848
6  status-completed    647
7  tags                524
8  reputation          426
9  area51              372
10 questions           354
17/10/2022:INFO:/main.py:Processing:
hadoop jar /home/mcoutada/hadoop/hadoop-3.3.4/share/hadoop/tools/lib/hadoop-streaming-3.3.4.jar -input /alkemybigdata/Stack_Overflow_11-2010/112010_Stack_Overflow/posts.xml -output /alkemybigdata/Stack_Overflow_11-2010/output -mapper "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/mapper1.py" -reducer "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/reducer1.py"
2022-10-17 18:14:13,925 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:14:14,111 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:14:14,425 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/mcoutada/.staging/job_1665599427989_0040
2022-10-17 18:14:14,682 INFO mapred.FileInputFormat: Total input files to process : 1
2022-10-17 18:14:14,763 INFO mapreduce.JobSubmitter: number of splits:31
2022-10-17 18:14:14,902 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1665599427989_0040
2022-10-17 18:14:14,902 INFO mapreduce.JobSubmitter: Executing with tokens: []
2022-10-17 18:14:15,088 INFO conf.Configuration: resource-types.xml not found
2022-10-17 18:14:15,088 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.
2022-10-17 18:14:15,159 INFO impl.YarnClientImpl: Submitted application application_1665599427989_0040
2022-10-17 18:14:15,215 INFO mapreduce.Job: The url to track the job: http://DESKTOP-02T1JP6.localdomain:8088/proxy/application_1665599427989_0040/
2022-10-17 18:14:15,217 INFO mapreduce.Job: Running job: job_1665599427989_0040
2022-10-17 18:14:21,299 INFO mapreduce.Job: Job job_1665599427989_0040 running in uber mode : false
2022-10-17 18:14:21,300 INFO mapreduce.Job:  map 0% reduce 0%
2022-10-17 18:14:31,555 INFO mapreduce.Job:  map 16% reduce 0%
2022-10-17 18:14:32,563 INFO mapreduce.Job:  map 19% reduce 0%
2022-10-17 18:14:41,718 INFO mapreduce.Job:  map 32% reduce 0%
2022-10-17 18:14:42,738 INFO mapreduce.Job:  map 39% reduce 0%
2022-10-17 18:14:49,814 INFO mapreduce.Job:  map 42% reduce 0%
2022-10-17 18:14:50,820 INFO mapreduce.Job:  map 55% reduce 0%
2022-10-17 18:14:56,908 INFO mapreduce.Job:  map 58% reduce 0%
2022-10-17 18:14:58,919 INFO mapreduce.Job:  map 71% reduce 0%
2022-10-17 18:14:59,928 INFO mapreduce.Job:  map 71% reduce 24%
2022-10-17 18:15:03,966 INFO mapreduce.Job:  map 74% reduce 24%
2022-10-17 18:15:05,985 INFO mapreduce.Job:  map 74% reduce 25%
2022-10-17 18:15:06,991 INFO mapreduce.Job:  map 87% reduce 25%
2022-10-17 18:15:10,012 INFO mapreduce.Job:  map 90% reduce 25%
2022-10-17 18:15:12,035 INFO mapreduce.Job:  map 90% reduce 30%
2022-10-17 18:15:13,040 INFO mapreduce.Job:  map 94% reduce 30%
2022-10-17 18:15:14,046 INFO mapreduce.Job:  map 100% reduce 30%
2022-10-17 18:15:15,051 INFO mapreduce.Job:  map 100% reduce 100%
2022-10-17 18:15:15,061 INFO mapreduce.Job: Job job_1665599427989_0040 completed successfully
2022-10-17 18:15:15,160 INFO mapreduce.Job: Counters: 54
        File System Counters
                FILE: Number of bytes read=12711072
                FILE: Number of bytes written=34321042
                FILE: Number of read operations=0
                FILE: Number of large read operations=0
                FILE: Number of write operations=0
                HDFS: Number of bytes read=4085209361
                HDFS: Number of bytes written=300
                HDFS: Number of read operations=98
                HDFS: Number of large read operations=0
                HDFS: Number of write operations=2
                HDFS: Number of bytes read erasure-coded=0
        Job Counters 
                Launched map tasks=31
                Launched reduce tasks=1
                Data-local map tasks=31
                Total time spent by all maps in occupied slots (ms)=234105
                Total time spent by all reduces in occupied slots (ms)=32543
                Total time spent by all map tasks (ms)=234105
                Total time spent by all reduce tasks (ms)=32543
                Total vcore-milliseconds taken by all map tasks=234105
                Total vcore-milliseconds taken by all reduce tasks=32543
                Total megabyte-milliseconds taken by all map tasks=239723520
                Total megabyte-milliseconds taken by all reduce tasks=33324032
        Map-Reduce Framework
                Map input records=3675852
                Map output records=1093439
                Map output bytes=10524188
                Map output materialized bytes=12711252
                Input split bytes=4402
                Combine input records=0
                Combine output records=0
                Reduce input groups=22992
                Reduce shuffle bytes=12711252
                Reduce input records=1093439
                Reduce output records=10
                Spilled Records=2186878
                Shuffled Maps =31
                Failed Shuffles=0
                Merged Map outputs=31
                GC time elapsed (ms)=4965
                CPU time spent (ms)=82640
                Physical memory (bytes) snapshot=11446607872
                Virtual memory (bytes) snapshot=81931591680
                Total committed heap usage (bytes)=10862198784
                Peak Map Physical memory (bytes)=381083648
                Peak Map Virtual memory (bytes)=2564800512
                Peak Reduce Physical memory (bytes)=249159680
                Peak Reduce Virtual memory (bytes)=2564759552
        Shuffle Errors
                BAD_ID=0
                CONNECTION=0
                IO_ERROR=0
                WRONG_LENGTH=0
                WRONG_MAP=0
                WRONG_REDUCE=0
        File Input Format Counters 
                Bytes Read=4085204959
        File Output Format Counters 
                Bytes Written=300
2022-10-17 18:15:15,160 INFO streaming.StreamJob: Output directory: /alkemybigdata/Stack_Overflow_11-2010/output
17/10/2022:INFO:/main.py:Output:
1  c#                  35996
2  java                26921
3  iphone              23215
4  php                 21418
5  asp.net             20252
6  javascript          19320
7  .net                17249
8  jquery              15376
9  android             13132
10 c++                 12856
17/10/2022:INFO:/main.py:Processing:
hadoop jar /home/mcoutada/hadoop/hadoop-3.3.4/share/hadoop/tools/lib/hadoop-streaming-3.3.4.jar -input /alkemybigdata/Stack_Overflow_11-2010/112010_Meta_Stack_Overflow/posts.xml -output /alkemybigdata/Stack_Overflow_11-2010/output -mapper "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/mapper2.py" -reducer "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/reducer2.py"
2022-10-17 18:15:21,021 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:15:21,213 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:15:21,493 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/mcoutada/.staging/job_1665599427989_0041
2022-10-17 18:15:21,732 INFO mapred.FileInputFormat: Total input files to process : 1
2022-10-17 18:15:21,801 INFO mapreduce.JobSubmitter: number of splits:2
2022-10-17 18:15:21,916 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1665599427989_0041
2022-10-17 18:15:21,916 INFO mapreduce.JobSubmitter: Executing with tokens: []
2022-10-17 18:15:22,089 INFO conf.Configuration: resource-types.xml not found
2022-10-17 18:15:22,089 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.
2022-10-17 18:15:22,154 INFO impl.YarnClientImpl: Submitted application application_1665599427989_0041
2022-10-17 18:15:22,197 INFO mapreduce.Job: The url to track the job: http://DESKTOP-02T1JP6.localdomain:8088/proxy/application_1665599427989_0041/
2022-10-17 18:15:22,200 INFO mapreduce.Job: Running job: job_1665599427989_0041
2022-10-17 18:15:28,278 INFO mapreduce.Job: Job job_1665599427989_0041 running in uber mode : false
2022-10-17 18:15:28,279 INFO mapreduce.Job:  map 0% reduce 0%
2022-10-17 18:15:33,356 INFO mapreduce.Job:  map 100% reduce 0%
2022-10-17 18:15:38,392 INFO mapreduce.Job:  map 100% reduce 100%
2022-10-17 18:15:38,405 INFO mapreduce.Job: Job job_1665599427989_0041 completed successfully
2022-10-17 18:15:38,498 INFO mapreduce.Job: Counters: 54
        File System Counters
                FILE: Number of bytes read=720971
                FILE: Number of bytes written=2276163
                FILE: Number of read operations=0
                FILE: Number of large read operations=0
                FILE: Number of write operations=0
                HDFS: Number of bytes read=54797371
                HDFS: Number of bytes written=689621
                HDFS: Number of read operations=11
                HDFS: Number of large read operations=0
                HDFS: Number of write operations=2
                HDFS: Number of bytes read erasure-coded=0
        Job Counters 
                Launched map tasks=2
                Launched reduce tasks=1
                Data-local map tasks=2
                Total time spent by all maps in occupied slots (ms)=6916
                Total time spent by all reduces in occupied slots (ms)=2290
                Total time spent by all map tasks (ms)=6916
                Total time spent by all reduce tasks (ms)=2290
                Total vcore-milliseconds taken by all map tasks=6916
                Total vcore-milliseconds taken by all reduce tasks=2290
                Total megabyte-milliseconds taken by all map tasks=7081984
                Total megabyte-milliseconds taken by all reduce tasks=2344960
        Map-Reduce Framework
                Map input records=56977
                Map output records=15672
                Map output bytes=689621
                Map output materialized bytes=720977
                Input split bytes=294
                Combine input records=0
                Combine output records=0
                Reduce input groups=15672
                Reduce shuffle bytes=720977
                Reduce input records=15672
                Reduce output records=15672
                Spilled Records=31344
                Shuffled Maps =2
                Failed Shuffles=0
                Merged Map outputs=2
                GC time elapsed (ms)=147
                CPU time spent (ms)=4030
                Physical memory (bytes) snapshot=956162048
                Virtual memory (bytes) snapshot=7681933312
                Total committed heap usage (bytes)=963117056
                Peak Map Physical memory (bytes)=364064768
                Peak Map Virtual memory (bytes)=2559934464
                Peak Reduce Physical memory (bytes)=244310016
                Peak Reduce Virtual memory (bytes)=2562551808
        Shuffle Errors
                BAD_ID=0
                CONNECTION=0
                IO_ERROR=0
                WRONG_LENGTH=0
                WRONG_MAP=0
                WRONG_REDUCE=0
        File Input Format Counters 
                Bytes Read=54797077
        File Output Format Counters 
                Bytes Written=689621
2022-10-17 18:15:38,499 INFO streaming.StreamJob: Output directory: /alkemybigdata/Stack_Overflow_11-2010/output
cat: Unable to write to output stream.
17/10/2022:INFO:/main.py:Output:
Post_Id: 1          wrd_cnt/view_cnt: 0.04
Post_Id: 10         wrd_cnt/view_cnt: 0.12
Post_Id: 100        wrd_cnt/view_cnt: 0.05
Post_Id: 10000      wrd_cnt/view_cnt: 1.14
Post_Id: 10025      wrd_cnt/view_cnt: 1.62
Post_Id: 10026      wrd_cnt/view_cnt: 0.08
Post_Id: 10027      wrd_cnt/view_cnt: 1.16
Post_Id: 10032      wrd_cnt/view_cnt: 0.64
Post_Id: 10034      wrd_cnt/view_cnt: 0.28
Post_Id: 1004       wrd_cnt/view_cnt: 0.10
Post_Id: 10044      wrd_cnt/view_cnt: 0.80
Post_Id: 10047      wrd_cnt/view_cnt: 1.80
Post_Id: 10053      wrd_cnt/view_cnt: 0.49
Post_Id: 10055      wrd_cnt/view_cnt: 0.62
Post_Id: 10059      wrd_cnt/view_cnt: 1.17
17/10/2022:INFO:/main.py:Processing:
hadoop jar /home/mcoutada/hadoop/hadoop-3.3.4/share/hadoop/tools/lib/hadoop-streaming-3.3.4.jar -input /alkemybigdata/Stack_Overflow_11-2010/112010_Stack_Overflow/posts.xml -output /alkemybigdata/Stack_Overflow_11-2010/output -mapper "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/mapper2.py" -reducer "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/reducer2.py"
2022-10-17 18:15:44,097 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:15:44,276 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:15:44,502 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/mcoutada/.staging/job_1665599427989_0042
2022-10-17 18:15:44,745 INFO mapred.FileInputFormat: Total input files to process : 1
2022-10-17 18:15:44,818 INFO mapreduce.JobSubmitter: number of splits:31
2022-10-17 18:15:44,952 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1665599427989_0042
2022-10-17 18:15:44,952 INFO mapreduce.JobSubmitter: Executing with tokens: []
2022-10-17 18:15:45,131 INFO conf.Configuration: resource-types.xml not found
2022-10-17 18:15:45,132 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.
2022-10-17 18:15:45,195 INFO impl.YarnClientImpl: Submitted application application_1665599427989_0042
2022-10-17 18:15:45,239 INFO mapreduce.Job: The url to track the job: http://DESKTOP-02T1JP6.localdomain:8088/proxy/application_1665599427989_0042/
2022-10-17 18:15:45,241 INFO mapreduce.Job: Running job: job_1665599427989_0042
2022-10-17 18:15:51,316 INFO mapreduce.Job: Job job_1665599427989_0042 running in uber mode : false
2022-10-17 18:15:51,317 INFO mapreduce.Job:  map 0% reduce 0%
2022-10-17 18:16:01,524 INFO mapreduce.Job:  map 6% reduce 0%
2022-10-17 18:16:02,531 INFO mapreduce.Job:  map 19% reduce 0%
2022-10-17 18:16:12,641 INFO mapreduce.Job:  map 39% reduce 0%
2022-10-17 18:16:21,730 INFO mapreduce.Job:  map 48% reduce 0%
2022-10-17 18:16:22,747 INFO mapreduce.Job:  map 55% reduce 0%
2022-10-17 18:16:28,786 INFO mapreduce.Job:  map 55% reduce 18%
2022-10-17 18:16:30,800 INFO mapreduce.Job:  map 65% reduce 18%
2022-10-17 18:16:31,806 INFO mapreduce.Job:  map 71% reduce 18%
2022-10-17 18:16:34,830 INFO mapreduce.Job:  map 71% reduce 24%
2022-10-17 18:16:39,874 INFO mapreduce.Job:  map 81% reduce 24%
2022-10-17 18:16:40,881 INFO mapreduce.Job:  map 84% reduce 27%
2022-10-17 18:16:41,887 INFO mapreduce.Job:  map 87% reduce 27%
2022-10-17 18:16:45,933 INFO mapreduce.Job: Task Id : attempt_1665599427989_0042_m_000029_0, Status : FAILED
Error: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1
        at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:326)
        at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:539)
        at org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)
        at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)
        at org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)
        at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:466)
        at org.apache.hadoop.mapred.MapTask.run(MapTask.java:350)
        at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:178)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:422)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878)
        at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:172)

2022-10-17 18:16:46,964 INFO mapreduce.Job:  map 87% reduce 29%
2022-10-17 18:16:47,969 INFO mapreduce.Job:  map 97% reduce 29%
2022-10-17 18:16:51,991 INFO mapreduce.Job: Task Id : attempt_1665599427989_0042_m_000029_1, Status : FAILED
Error: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1
        at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:326)
        at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:539)
        at org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)
        at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)
        at org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)
        at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:466)
        at org.apache.hadoop.mapred.MapTask.run(MapTask.java:350)
        at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:178)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:422)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878)
        at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:172)

2022-10-17 18:16:52,997 INFO mapreduce.Job:  map 97% reduce 32%
2022-10-17 18:16:58,025 INFO mapreduce.Job: Task Id : attempt_1665599427989_0042_m_000029_2, Status : FAILED
Error: java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1
        at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:326)
        at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:539)
        at org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:130)
        at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:61)
        at org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:34)
        at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:466)
        at org.apache.hadoop.mapred.MapTask.run(MapTask.java:350)
        at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:178)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:422)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1878)
        at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:172)

2022-10-17 18:17:06,064 INFO mapreduce.Job:  map 100% reduce 100%
2022-10-17 18:17:06,074 INFO mapreduce.Job: Job job_1665599427989_0042 failed with state FAILED due to: Task failed task_1665599427989_0042_m_000029
Job failed as tasks failed. failedMaps:1 failedReduces:0 killedMaps:0 killedReduces: 0

2022-10-17 18:17:06,166 INFO mapreduce.Job: Counters: 42
        File System Counters
                FILE: Number of bytes read=0
                FILE: Number of bytes written=54210900
                FILE: Number of read operations=0
                FILE: Number of large read operations=0
                FILE: Number of write operations=0
                HDFS: Number of bytes read=3950983299
                HDFS: Number of bytes written=0
                HDFS: Number of read operations=90
                HDFS: Number of large read operations=0
                HDFS: Number of write operations=0
                HDFS: Number of bytes read erasure-coded=0
        Job Counters 
                Failed map tasks=4
                Killed reduce tasks=1
                Launched map tasks=34
                Launched reduce tasks=1
                Other local map tasks=3
                Data-local map tasks=31
                Total time spent by all maps in occupied slots (ms)=276141
                Total time spent by all reduces in occupied slots (ms)=52912
                Total time spent by all map tasks (ms)=276141
                Total time spent by all reduce tasks (ms)=52912
                Total vcore-milliseconds taken by all map tasks=276141
                Total vcore-milliseconds taken by all reduce tasks=52912
                Total megabyte-milliseconds taken by all map tasks=282768384
                Total megabyte-milliseconds taken by all reduce tasks=54181888
        Map-Reduce Framework
                Map input records=3561500
                Map output records=996742
                Map output bytes=43874636
                Map output materialized bytes=45868300
                Input split bytes=4260
                Combine input records=0
                Spilled Records=996742
                Failed Shuffles=0
                Merged Map outputs=0
                GC time elapsed (ms)=4868
                CPU time spent (ms)=70470
                Physical memory (bytes) snapshot=10695061504
                Virtual memory (bytes) snapshot=76775112704
                Total committed heap usage (bytes)=9749135360
                Peak Map Physical memory (bytes)=381100032
                Peak Map Virtual memory (bytes)=2563190784
        File Input Format Counters 
                Bytes Read=3950979039
2022-10-17 18:17:06,167 ERROR streaming.StreamJob: Job not successful!
Streaming Command Failed!
cat: `/alkemybigdata/Stack_Overflow_11-2010/output/part-00000': No such file or directory
17/10/2022:INFO:/main.py:Output:

17/10/2022:INFO:/main.py:Processing:
hadoop jar /home/mcoutada/hadoop/hadoop-3.3.4/share/hadoop/tools/lib/hadoop-streaming-3.3.4.jar -input /alkemybigdata/Stack_Overflow_11-2010/112010_Meta_Stack_Overflow/posts.xml -output /alkemybigdata/Stack_Overflow_11-2010/output -mapper "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/mapper3.py" -reducer "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/reducer3.py"
2022-10-17 18:17:12,127 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:17:12,348 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:17:12,600 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/mcoutada/.staging/job_1665599427989_0043
2022-10-17 18:17:12,855 INFO mapred.FileInputFormat: Total input files to process : 1
2022-10-17 18:17:12,913 INFO mapreduce.JobSubmitter: number of splits:2
2022-10-17 18:17:13,041 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1665599427989_0043
2022-10-17 18:17:13,042 INFO mapreduce.JobSubmitter: Executing with tokens: []
2022-10-17 18:17:13,224 INFO conf.Configuration: resource-types.xml not found
2022-10-17 18:17:13,225 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.
2022-10-17 18:17:13,294 INFO impl.YarnClientImpl: Submitted application application_1665599427989_0043
2022-10-17 18:17:13,350 INFO mapreduce.Job: The url to track the job: http://DESKTOP-02T1JP6.localdomain:8088/proxy/application_1665599427989_0043/
2022-10-17 18:17:13,352 INFO mapreduce.Job: Running job: job_1665599427989_0043
2022-10-17 18:17:20,439 INFO mapreduce.Job: Job job_1665599427989_0043 running in uber mode : false
2022-10-17 18:17:20,440 INFO mapreduce.Job:  map 0% reduce 0%
2022-10-17 18:17:25,509 INFO mapreduce.Job:  map 100% reduce 0%
2022-10-17 18:17:30,544 INFO mapreduce.Job:  map 100% reduce 100%
2022-10-17 18:17:30,557 INFO mapreduce.Job: Job job_1665599427989_0043 completed successfully
2022-10-17 18:17:30,655 INFO mapreduce.Job: Counters: 54
        File System Counters
                FILE: Number of bytes read=6
                FILE: Number of bytes written=834230
                FILE: Number of read operations=0
                FILE: Number of large read operations=0
                FILE: Number of write operations=0
                HDFS: Number of bytes read=54797371
                HDFS: Number of bytes written=0
                HDFS: Number of read operations=11
                HDFS: Number of large read operations=0
                HDFS: Number of write operations=2
                HDFS: Number of bytes read erasure-coded=0
        Job Counters 
                Launched map tasks=2
                Launched reduce tasks=1
                Data-local map tasks=2
                Total time spent by all maps in occupied slots (ms)=6585
                Total time spent by all reduces in occupied slots (ms)=2276
                Total time spent by all map tasks (ms)=6585
                Total time spent by all reduce tasks (ms)=2276
                Total vcore-milliseconds taken by all map tasks=6585
                Total vcore-milliseconds taken by all reduce tasks=2276
                Total megabyte-milliseconds taken by all map tasks=6743040
                Total megabyte-milliseconds taken by all reduce tasks=2330624
        Map-Reduce Framework
                Map input records=56977
                Map output records=0
                Map output bytes=0
                Map output materialized bytes=12
                Input split bytes=294
                Combine input records=0
                Combine output records=0
                Reduce input groups=0
                Reduce shuffle bytes=12
                Reduce input records=0
                Reduce output records=0
                Spilled Records=0
                Shuffled Maps =2
                Failed Shuffles=0
                Merged Map outputs=2
                GC time elapsed (ms)=156
                CPU time spent (ms)=3220
                Physical memory (bytes) snapshot=935366656
                Virtual memory (bytes) snapshot=7679778816
                Total committed heap usage (bytes)=861929472
                Peak Map Physical memory (bytes)=349237248
                Peak Map Virtual memory (bytes)=2559373312
                Peak Reduce Physical memory (bytes)=239771648
                Peak Reduce Virtual memory (bytes)=2563366912
        Shuffle Errors
                BAD_ID=0
                CONNECTION=0
                IO_ERROR=0
                WRONG_LENGTH=0
                WRONG_MAP=0
                WRONG_REDUCE=0
        File Input Format Counters 
                Bytes Read=54797077
        File Output Format Counters 
                Bytes Written=0
2022-10-17 18:17:30,656 INFO streaming.StreamJob: Output directory: /alkemybigdata/Stack_Overflow_11-2010/output
17/10/2022:INFO:/main.py:Output:

17/10/2022:INFO:/main.py:Processing:
hadoop jar /home/mcoutada/hadoop/hadoop-3.3.4/share/hadoop/tools/lib/hadoop-streaming-3.3.4.jar -input /alkemybigdata/Stack_Overflow_11-2010/112010_Stack_Overflow/posts.xml -output /alkemybigdata/Stack_Overflow_11-2010/output -mapper "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/mapper3.py" -reducer "python3 /home/mcoutada/alkemy/OT303-python/bigdata/SPRINT03/OT303-102/include/reducer3.py"
2022-10-17 18:17:36,781 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:17:36,975 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at /0.0.0.0:8032
2022-10-17 18:17:37,218 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/mcoutada/.staging/job_1665599427989_0044
2022-10-17 18:17:37,627 INFO mapred.FileInputFormat: Total input files to process : 1
2022-10-17 18:17:37,697 INFO mapreduce.JobSubmitter: number of splits:31
2022-10-17 18:17:37,824 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1665599427989_0044
2022-10-17 18:17:37,824 INFO mapreduce.JobSubmitter: Executing with tokens: []
2022-10-17 18:17:38,023 INFO conf.Configuration: resource-types.xml not found
2022-10-17 18:17:38,023 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.
2022-10-17 18:17:38,099 INFO impl.YarnClientImpl: Submitted application application_1665599427989_0044
2022-10-17 18:17:38,149 INFO mapreduce.Job: The url to track the job: http://DESKTOP-02T1JP6.localdomain:8088/proxy/application_1665599427989_0044/
2022-10-17 18:17:38,151 INFO mapreduce.Job: Running job: job_1665599427989_0044
2022-10-17 18:17:44,255 INFO mapreduce.Job: Job job_1665599427989_0044 running in uber mode : false
2022-10-17 18:17:44,257 INFO mapreduce.Job:  map 0% reduce 0%
2022-10-17 18:17:53,439 INFO mapreduce.Job:  map 10% reduce 0%
2022-10-17 18:17:54,447 INFO mapreduce.Job:  map 19% reduce 0%
2022-10-17 18:18:02,562 INFO mapreduce.Job:  map 39% reduce 0%
2022-10-17 18:18:10,679 INFO mapreduce.Job:  map 42% reduce 0%
2022-10-17 18:18:11,686 INFO mapreduce.Job:  map 55% reduce 0%
2022-10-17 18:18:17,736 INFO mapreduce.Job:  map 58% reduce 0%
2022-10-17 18:18:18,744 INFO mapreduce.Job:  map 65% reduce 0%
2022-10-17 18:18:19,753 INFO mapreduce.Job:  map 71% reduce 0%
2022-10-17 18:18:21,774 INFO mapreduce.Job:  map 71% reduce 24%
2022-10-17 18:18:24,812 INFO mapreduce.Job:  map 74% reduce 24%
2022-10-17 18:18:26,835 INFO mapreduce.Job:  map 84% reduce 24%
2022-10-17 18:18:27,844 INFO mapreduce.Job:  map 87% reduce 28%
2022-10-17 18:18:30,862 INFO mapreduce.Job:  map 90% reduce 28%
2022-10-17 18:18:32,883 INFO mapreduce.Job:  map 100% reduce 28%
2022-10-17 18:18:33,888 INFO mapreduce.Job:  map 100% reduce 100%
2022-10-17 18:18:33,899 INFO mapreduce.Job: Job job_1665599427989_0044 completed successfully
2022-10-17 18:18:34,001 INFO mapreduce.Job: Counters: 55
        File System Counters
                FILE: Number of bytes read=6
                FILE: Number of bytes written=8898910
                FILE: Number of read operations=0
                FILE: Number of large read operations=0
                FILE: Number of write operations=0
                HDFS: Number of bytes read=4085209361
                HDFS: Number of bytes written=0
                HDFS: Number of read operations=98
                HDFS: Number of large read operations=0
                HDFS: Number of write operations=2
                HDFS: Number of bytes read erasure-coded=0
        Job Counters 
                Killed map tasks=1
                Launched map tasks=31
                Launched reduce tasks=1
                Data-local map tasks=31
                Total time spent by all maps in occupied slots (ms)=217856
                Total time spent by all reduces in occupied slots (ms)=30445
                Total time spent by all map tasks (ms)=217856
                Total time spent by all reduce tasks (ms)=30445
                Total vcore-milliseconds taken by all map tasks=217856
                Total vcore-milliseconds taken by all reduce tasks=30445
                Total megabyte-milliseconds taken by all map tasks=223084544
                Total megabyte-milliseconds taken by all reduce tasks=31175680
        Map-Reduce Framework
                Map input records=3675852
                Map output records=0
                Map output bytes=0
                Map output materialized bytes=186
                Input split bytes=4402
                Combine input records=0
                Combine output records=0
                Reduce input groups=0
                Reduce shuffle bytes=186
                Reduce input records=0
                Reduce output records=0
                Spilled Records=0
                Shuffled Maps =31
                Failed Shuffles=0
                Merged Map outputs=31
                GC time elapsed (ms)=6127
                CPU time spent (ms)=67200
                Physical memory (bytes) snapshot=11342761984
                Virtual memory (bytes) snapshot=81880641536
                Total committed heap usage (bytes)=11269570560
                Peak Map Physical memory (bytes)=377634816
                Peak Map Virtual memory (bytes)=2562215936
                Peak Reduce Physical memory (bytes)=269012992
                Peak Reduce Virtual memory (bytes)=2562633728
        Shuffle Errors
                BAD_ID=0
                CONNECTION=0
                IO_ERROR=0
                WRONG_LENGTH=0
                WRONG_MAP=0
                WRONG_REDUCE=0
        File Input Format Counters 
                Bytes Read=4085204959
        File Output Format Counters 
                Bytes Written=0
2022-10-17 18:18:34,002 INFO streaming.StreamJob: Output directory: /alkemybigdata/Stack_Overflow_11-2010/output
17/10/2022:INFO:/main.py:Output:

17/10/2022:INFO:/main.py:Ended __main__.main(). Elapsed: 293.9119 seconds
mcoutada@DESKTOP-02T1JP6:~/alkemy/OT303-python/bigdata/SPRINT03/OT303-102$ 